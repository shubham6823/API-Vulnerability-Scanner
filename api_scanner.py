import requests

def check_headers(url):
    headers = {
        'User-Agent': 'API Vulnerability Scanner'
    }

    try:
        response = requests.get(url, headers=headers)
        security_headers = ['X-Content-Type-Options', 'Strict-Transport-Security', 'X-Frame-Options']
        missing_headers = []
        found_headers = []

        for header in security_headers:
            if header in response.headers:
                found_headers.append(f"{header}: {response.headers[header]}")
            else:
                missing_headers.append(header)

        return missing_headers, found_headers
    except requests.exceptions.RequestException as e:
        return f"Error scanning URL: {e}", []

def scan_api(url):
    missing_headers, found_headers = check_headers(url)

    if missing_headers:
        result = f"Missing security headers: {', '.join(missing_headers)}"
    else:
        result = "No missing security headers."

    # Include found headers in the result
    if found_headers:
        result += f"\nFound security headers:\n" + "\n".join(found_headers)
    
    print(result)  # Print result to debug
    return result
